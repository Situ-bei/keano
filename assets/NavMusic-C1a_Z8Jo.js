const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/APlayer.min-CAgWaKXK.js","assets/commonjsHelpers-Cpj98o6Y.js"])))=>i.map(i=>d[i]);
import{j as b,p as h,l as P,J as A,X as L,Y as S,W as w,_ as I,r as E,o as G,m as x,f as C,a as c,Z as B,b as N}from"./app-uB1A-8lK.js";import k from"./MyIcon-DrsywuED.js";const T=`
  <div class="custom-aplayer">
    <button class="custom-play">播放</button>
    <button class="custom-pause">暂停</button>
    <div class="custom-progress">
      <div class="custom-loaded"></div>
      <div class="custom-played"></div>
    </div>
  </div>
`,R=b({__name:"NavMusic",setup(v,{expose:r}){r();const d=h();let s="https://api.injahow.cn/meting/?server=netease&type=playlist&id=596766562&auth=:auth&r=:r",n,l=P(!1),a=[];const f=()=>{l.value=!l.value},g=()=>{l.value&&(l.value=!1)},m=()=>{const e=document.querySelector(".vp-navbar-end");if(!e)return;if(!document.querySelector("#MyMusic_Menu")){const o=document.createElement("div");o.id="MyMusic_Menu",o.classList.add("nav-item"),o.innerHTML='<div id="MyMusic_icon" class="btnImg"></div>',e.appendChild(o)}const t=document.querySelector("#MyMusic_Menu");t.onclick=o=>{f(),o.stopPropagation()};const i=document.querySelector(".MyMusic");i.onclick=o=>{o.stopPropagation()}};function u(){var t,i;const e=window;e.GlobalAPlayer&&e.GlobalAPlayer.mode&&(e.GlobalAPlayer.paused?(t=document.getElementById("MyMusic_icon"))==null||t.setAttribute("spin","false"):(i=document.getElementById("MyMusic_icon"))==null||i.setAttribute("spin","true"))}const y=()=>{if(!n)return;const e=window,t=document.getElementById("GlobalAPlayer");!t||a.length<1||(u(),t.classList.contains("aplayer"))||(e.GlobalAPlayer=new n({container:document.getElementById("GlobalAPlayer"),audio:a,lrcType:3,listFolded:!1,listMaxHeight:"324px",mini:!1,fixed:!1,volume:2,storageName:"GlobalAPlayer"}),console.log("APlayer 接管，播放器已创建"),e.GlobalAPlayer.on("play",function(){u()}),e.GlobalAPlayer.on("pause",function(){u()}))},p=async()=>{console.log("当前歌单api",s);try{await L({method:"get",url:s,params:{}}).then(e=>{if(console.log("获取音乐数据,判断之前",e.data.message),e.data.message=="请求次数已达上限，请明天再试")return alert("音乐API请求次数已达上限，请明天再试"),s="//api.i-meto.com/meting/api?server=netease&type=playlist&id=596766562&r=:r",alert("赋值"),p();const t=e.data;t&&t.length>0&&(a=t,console.log("已经获取歌单成功并赋值",a)),_()})}catch(e){alert(`
      歌单获取失败 
      错误信息：${e.message}
      错误代码：${e.code}
      `),console.error("加载音乐列表失败:",e)}},_=()=>{S(()=>import("./APlayer.min-CAgWaKXK.js").then(e=>e.A),__vite__mapDeps([0,1])).then(e=>{w(()=>{n=e.default,m(),y()}),d.afterEach((t,i)=>{console.log("监测到路由更新"),setTimeout(()=>{m(),y(),console.log("路由更新,更新播放器实例afterEach")},30)})})};A(()=>{p()});const M={router:d,get musicListURL(){return s},set musicListURL(e){s=e},get APlayer(){return n},set APlayer(e){n=e},get IsShow(){return l},set IsShow(e){l=e},get GlobalMusicList(){return a},set GlobalMusicList(e){a=e},customTemplate:T,SwitchStatus:f,CloseStatus:g,InsertMenu:m,AddBtnSpin:u,NewPlayer:y,LoadMusicList:p,creatAplayer:_,MyIcon:k};return Object.defineProperty(M,"__isScriptSetup",{enumerable:!1,value:!0}),M}}),q={class:"MyMusic"};function O(v,r,d,s,n,l){const a=E("ClientOnly");return G(),x(a,null,{default:C(()=>[c("div",q,[c("div",{class:B(["MyMusic_Play",{hide:!s.IsShow}])},[c("div",{class:"close",onClick:s.CloseStatus},[N(s.MyIcon,{name:"guanbi"})]),r[0]||(r[0]=c("div",{id:"GlobalAPlayer"},[c("div",{class:"aplayer-lrc"})],-1))],2)])]),_:1})}const U=I(R,[["render",O],["__file","NavMusic.vue"]]);export{U as default};

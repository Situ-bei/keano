const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/APlayer.min-CAgWaKXK.js","assets/commonjsHelpers-Cpj98o6Y.js"])))=>i.map(i=>d[i]);
import{j as g,_ as b,o as h,c as S,Y as P,p as I,l as L,J as w,X as x,Z as E,W as G,r as C,m as B,f as $,a as u,d as k}from"./app-DG673I2C.js";const N=g({__name:"MyIcon",props:{name:String,spin:Boolean},setup(d,{expose:l}){l();const t={props:d};return Object.defineProperty(t,"__isScriptSetup",{enumerable:!1,value:!0}),t}}),T=["spin"];function O(d,l,r,t,i,o){return h(),S("span",{class:P(["iconfont icon",`icon-${t.props.name}`]),spin:t.props.spin},null,10,T)}const R=b(N,[["render",O],["__file","MyIcon.vue"]]),j=`
  <div class="custom-aplayer">
    <button class="custom-play">播放</button>
    <button class="custom-pause">暂停</button>
    <div class="custom-progress">
      <div class="custom-loaded"></div>
      <div class="custom-played"></div>
    </div>
  </div>
`,q=g({__name:"NavMusic",setup(d,{expose:l}){l();const r=I();let t="https://api.injahow.cn/meting/?server=netease&type=playlist&id=596766562&auth=:auth&r=:r",i,o=L(!1),a=[];const f=()=>{o.value=!o.value},A=()=>{o.value&&(o.value=!1)},m=()=>{const e=document.querySelector(".vp-navbar-end");if(!e)return;if(!document.querySelector("#MyMusic_Menu")){const n=document.createElement("div");n.id="MyMusic_Menu",n.classList.add("nav-item"),n.innerHTML='<div id="MyMusic_icon" class="btnImg"></div>',e.appendChild(n)}const s=document.querySelector("#MyMusic_Menu");s.onclick=n=>{f(),n.stopPropagation()};const c=document.querySelector(".MyMusic");c.onclick=n=>{n.stopPropagation()}};function p(){var s,c;const e=window;e.GlobalAPlayer&&e.GlobalAPlayer.mode&&(e.GlobalAPlayer.paused?(s=document.getElementById("MyMusic_icon"))==null||s.setAttribute("spin","false"):(c=document.getElementById("MyMusic_icon"))==null||c.setAttribute("spin","true"))}const y=()=>{if(!i)return;const e=window,s=document.getElementById("GlobalAPlayer");!s||a.length<1||(p(),s.classList.contains("aplayer"))||(e.GlobalAPlayer=new i({container:document.getElementById("GlobalAPlayer"),audio:a,lrcType:3,listFolded:!1,listMaxHeight:"324px",mini:!1,fixed:!1,volume:2,storageName:"GlobalAPlayer"}),console.log("APlayer 接管，播放器已创建"),e.GlobalAPlayer.on("play",function(){p()}),e.GlobalAPlayer.on("pause",function(){p()}))},_=async()=>{console.log("当前歌单api",t);try{await x({method:"get",url:t,params:{}}).then(e=>{if(console.log("获取音乐数据,判断之前",e.data.message),e.data.message=="请求次数已达上限，请明天再试")return alert("音乐API请求次数已达上限，请明天再试"),t="//api.i-meto.com/meting/api?server=netease&type=playlist&id=596766562&r=:r",alert("赋值"),_();const s=e.data;s&&s.length>0&&(a=s,console.log("已经获取歌单成功并赋值",a)),M()})}catch(e){alert(`
      歌单获取失败 
      错误信息：${e.message}
      错误代码：${e.code}
      `),console.error("加载音乐列表失败:",e)}},M=()=>{E(()=>import("./APlayer.min-CAgWaKXK.js").then(e=>e.A),__vite__mapDeps([0,1])).then(e=>{G(()=>{i=e.default,m(),y()}),r.afterEach((s,c)=>{console.log("监测到路由更新"),setTimeout(()=>{m(),y(),console.log("路由更新,更新播放器实例afterEach")},30)})})};w(()=>{_()});const v={router:r,get musicListURL(){return t},set musicListURL(e){t=e},get APlayer(){return i},set APlayer(e){i=e},get IsShow(){return o},set IsShow(e){o=e},get GlobalMusicList(){return a},set GlobalMusicList(e){a=e},customTemplate:j,SwitchStatus:f,CloseStatus:A,InsertMenu:m,AddBtnSpin:p,NewPlayer:y,LoadMusicList:_,creatAplayer:M,MyIcon:R};return Object.defineProperty(v,"__isScriptSetup",{enumerable:!1,value:!0}),v}}),W={class:"MyMusic"};function U(d,l,r,t,i,o){const a=C("ClientOnly");return h(),B(a,null,{default:$(()=>[u("div",W,[u("div",{class:P(["MyMusic_Play",{hide:!t.IsShow}])},[u("div",{class:"close",onClick:t.CloseStatus},[k(t.MyIcon,{name:"guanbi"})]),l[0]||(l[0]=u("div",{id:"GlobalAPlayer"},[u("div",{class:"aplayer-lrc"})],-1))],2)])]),_:1})}const D=b(q,[["render",U],["__file","NavMusic.vue"]]);export{D as default};
